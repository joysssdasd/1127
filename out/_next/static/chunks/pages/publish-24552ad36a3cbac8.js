(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[492],{5580:function(e,s,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/publish",function(){return n(4731)}])},2021:function(e,s,n){"use strict";n.d(s,{Z:function(){return d}});var a=n(5893),l=n(1664),r=n.n(l),i=n(1163),t=n(4611);let c=[{href:"/",label:"首页"},{href:"/publish",label:"发布"},{href:"/search",label:"智能搜索"},{href:"/recharge",label:"积分充值"},{href:"/me",label:"个人中心"}];function d(e){var s,n,l;let{children:d}=e,h=(0,i.useRouter)(),{user:o,logout:u}=(0,t.a)(),x=e=>"/"===e?"/"===h.pathname:h.pathname===e||h.pathname.startsWith("".concat(e,"/"));return(0,a.jsxs)("div",{style:{padding:"0 20px"},children:[(0,a.jsxs)("header",{className:"app-header",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"app-brand",children:"C2C 情报局"}),(0,a.jsx)("div",{style:{fontSize:12,color:"var(--muted)"},children:"72 小时自动下架 \xb7 智能风控撮合 \xb7 Supabase 实时底座"})]}),(0,a.jsx)("nav",{className:"app-nav",children:c.map(e=>(0,a.jsx)(r(),{href:e.href,className:x(e.href)?"active":void 0,children:e.label},e.href))}),(0,a.jsx)("div",{className:"user-chip",children:o?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{style:{fontWeight:600},children:null!==(s=o.phone)&&void 0!==s?s:"未绑定手机"}),(0,a.jsxs)("div",{style:{fontSize:12,color:"var(--muted)"},children:["微信：",null!==(n=o.wechat)&&void 0!==n?n:"未设置"," \xb7 积分 ",null!==(l=o.points)&&void 0!==l?l:0]})]}),(0,a.jsx)("button",{className:"secondary-btn",onClick:u,children:"退出"})]}):(0,a.jsx)(r(),{className:"primary-btn",href:"/auth/login",children:"登录 / 入驻"})})]}),(0,a.jsx)("main",{style:{maxWidth:1200,margin:"0 auto 60px",padding:"0 8px"},children:d})]})}},971:function(e,s,n){"use strict";n.d(s,{F:function(){return l}});var a=n(5893);function l(e){let{message:s}=e;return s?(0,a.jsx)("div",{className:"toast",children:s}):null}},7996:function(e,s,n){"use strict";n.d(s,{p:function(){return l}});var a=n(7294);function l(){let[e,s]=(0,a.useState)(null);return{message:e,show:(0,a.useCallback)(e=>{s(e),window.setTimeout(()=>s(null),2500)},[])}}},4731:function(e,s,n){"use strict";n.r(s),n.d(s,{default:function(){return o}});var a=n(5893),l=n(7294),r=n(1664),i=n.n(r),t=n(2021),c=n(4611),d=n(971),h=n(7996);function o(){var e;let{tokens:s,user:n}=(0,c.a)(),{message:r,show:o}=(0,h.p)(),[u,x]=(0,l.useState)(""),[p,j]=(0,l.useState)(""),[v,m]=(0,l.useState)(100),[f,g]=(0,l.useState)("sell"),[b,y]=(0,l.useState)(""),[N,w]=(0,l.useState)(!0),[C,k]=(0,l.useState)(!1),S=async()=>{if(!s){o("请先登录");return}if(!u.trim()||!p.trim()){o("请完整填写标题和描述");return}k(!0);try{let n=await fetch("/api/listings",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s.accessToken)},body:JSON.stringify({title:u,description:p,price:v,tradeType:f,keywords:b.split(",").map(e=>e.trim()).filter(Boolean),aiAssist:N})}),a=await n.json();if(!n.ok){var e;throw Error(null!==(e=a.error)&&void 0!==e?e:"发布失败")}o("发布成功，等待买家解锁微信"),x(""),j(""),y("")}catch(e){o(e.message)}finally{k(!1)}};return(0,a.jsxs)(t.Z,{children:[(0,a.jsxs)("div",{className:"page-section",children:[(0,a.jsx)("div",{className:"section-heading",children:"发布信息"}),(0,a.jsx)("p",{className:"section-subtitle",children:"所有信息默认 72 小时下架，再次上架会刷新剩余查看次数。"}),(0,a.jsxs)("div",{className:"grid-three",children:[(0,a.jsxs)("div",{className:"feature-card",children:[(0,a.jsx)("h3",{style:{marginTop:0},children:"微信默认透出"}),(0,a.jsxs)("p",{style:{color:"var(--muted)"},children:["当前绑定微信：",null!==(e=null==n?void 0:n.wechat)&&void 0!==e?e:"未设置"," \xb7"," ",(0,a.jsx)(i(),{href:"/me",style:{color:"#0a84ff"},children:"去个人中心更新"})]})]}),(0,a.jsxs)("div",{className:"feature-card",children:[(0,a.jsx)("h3",{style:{marginTop:0},children:"AI 补充文案"}),(0,a.jsx)("p",{style:{color:"var(--muted)"},children:"勾选 AI 辅助即可自动生成标签与卖点，提升曝光率。"})]}),(0,a.jsxs)("div",{className:"feature-card",children:[(0,a.jsx)("h3",{style:{marginTop:0},children:"积分激励"}),(0,a.jsx)("p",{style:{color:"var(--muted)"},children:"成交后积分自动返还，积分流水可在后台&个人中心查询。"})]})]})]}),(0,a.jsx)("div",{className:"page-section",style:{maxWidth:760,margin:"0 auto"},children:(0,a.jsxs)("div",{className:"form-grid",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"标题"}),(0,a.jsx)("input",{value:u,onChange:e=>x(e.target.value),placeholder:"例如：全新 iPhone 16 Pro 现货"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"描述"}),(0,a.jsx)("textarea",{value:p,onChange:e=>j(e.target.value),rows:4,placeholder:"请写明配置、成色、交易方式、城市等关键信息"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"价格（积分）"}),(0,a.jsx)("input",{type:"number",min:1,value:v,onChange:e=>m(Number(e.target.value))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"交易类型"}),(0,a.jsxs)("select",{value:f,onChange:e=>g(e.target.value),children:[(0,a.jsx)("option",{value:"sell",children:"出售"}),(0,a.jsx)("option",{value:"buy",children:"求购"}),(0,a.jsx)("option",{value:"trade",children:"互换"}),(0,a.jsx)("option",{value:"other",children:"其他"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{children:"关键词（逗号分隔）"}),(0,a.jsx)("input",{value:b,onChange:e=>y(e.target.value),placeholder:"苹果, 信义区, 面交"})]}),(0,a.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,a.jsx)("input",{type:"checkbox",checked:N,onChange:e=>w(e.target.checked)}),(0,a.jsx)("span",{children:"开启 AI 辅助写作"})]}),(0,a.jsx)("button",{className:"primary-btn",onClick:S,disabled:C,children:C?"发布中...":"发布并扣除 10 次查看额度"})]})}),(0,a.jsx)(d.F,{message:r})]})}}},function(e){e.O(0,[424,888,774,179],function(){return e(e.s=5580)}),_N_E=e.O()}]);